定义控制文件 
===========================

OBLOADER 可通过预定义的控制文件对导入的数据进行预处理。

文件模板 
-------------------------

控制文件的定义模版如下：

```sql
lang=java 
(
  列名 字节偏移位置(可选) "预处理函数"（可选） 映射定义（可选）,
  列名 字节偏移位置(可选) "预处理函数"（可选） 映射定义（可选）,
  列名 字节偏移位置(可选) "预处理函数"（可选） 映射定义（可选）,
  列名 字节偏移位置(可选) "预处理函数"（可选） 映射定义（可选）
);
```



现有的控制文件设计如下（field_position 为数据文件中的字段位置）：

```sql
lang=java server=mysql|oracle (     
c1 "nvl(c1, 'not null')" map(field_position),     
c2 "none" map(field_position)
 );
```



控制文件的命名格式为 **表名.ctrl** ，控制文件的内容要求文件中字段的顺序与表中定义的列顺序保持一致。对于 `--pos` 格式数据，文件中必须定义字节偏移位置。对于 `--cut` 格式数据，无需定义字节偏移位置。预处理函数定义请参见 **预处理函数** 。

注意事项 
-------------------------

* 如果表中定义的列名包含了数据库关键字，需要在列名前后添加反引号 ````` 进行转义。示例如下：

  

* OBLOADER 3.x 版本不再支持 map 文件，字段映射功能合并到 ctrl 文件中。示例如下：

  




示例 
-----------------------

* `--pos` 格式数据的控制文件示例如下：

  ```sql
  lang=java
  (
    c1 position(1:5) "trim(c1)",          -- 截取 c1 列的第 1 到第 5 个字节，并且对得到的结果两侧截断空格
    c2 position(7:25) "replace(trim(c2),'',' ')"   -- 截取 c2 列的第 7 到第 25 个字节，并且对得到的结果两侧截断空格，同时对于空字符用空格替代
  );
  ```

  

* `--cut`, `--csv`, `--sql` 格式数据的控制文件示例如下：

  

* 数据清洗的控制文件示例如下：

  ```sql
  -- 表名 test, 控制文件名 test.ctrl，配置内容如下：
  
  lang=java (
    c1 "nvl(c1, 'replacement')",             
    c2 "replace(c2,'','replacement')",                  
    c3 "tmsfmt(c3,'yyyyMMddHHmmsssSSSS','19700101000000000')"
  );
  ```

  
  **注意**

  

  导数工具 3.0.0 及之后的版本，OBLOADER 不再支持 `--null-replacer`, `--empty-replacer`, `--default-date`, `--date-format` 选项。
  





