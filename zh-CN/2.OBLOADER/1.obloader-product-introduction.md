产品简介 
=========================



什么是 OBLOADER 
---------------------------------

OBLOADER 是一款使用 Java 开发的客户端导入工具。该工具提供了非常灵活的命令行选项，可在多种复杂的场景下，将结构和数据导入到 OceanBase 数据库中。OBLOADER 主要与 OBDUMPER 搭配使用。但是在外部业务中，OBLOADER 也支持如 Navicat、Mydumper 和 SQLDeveloper 等工具导出的 SQL 或 CSV 格式的文件导入。OBLOADER 充分利用 OceanBase 分布式系统的特性，重点优化了导入的性能。

产品功能 
-------------------------

OBLOADER 提供向 OceanBase 数据库导入结构和数据的能力，主要具备以下功能特性：

* 支持导入 Schema 定义语句。

  

* 支持导入 CSV 和 SQL 格式的数据文件。

  

* 支持导入字节偏移量、字符串分隔和混合数据文件等复杂的数据格式。

  

* 支持配置简单的数据清洗规则。

  

* 支持配置数据预处理的控制规则。

  

* 支持配置文件与表之间的字段映射关系。

  

* 支持限流、防导爆、断点恢复和自动重试等特性。

  

* 支持指定自定义的日志目录、保存坏数据和冲突数据等特性。

  

* 支持限制模式导入数据，限制模式不依赖系统租户下的任意账号信息。

  

* 支持 OBLOADER 从 OSS 数据导入至 OceanBase 数据库。

  

* 支持忽略报错模式 (通过指定允许的报错数量)。

  

* 支持增量数据导入，并在主键/唯一键冲突时可正常替换数据。

  

* 支持导入结构时，自动处理数据库对象之间的依赖关系。

  




支持的 OceanBase 数据库 
--------------------------------------

支持连接的 OceanBase 数据库版本如下表所示：


|         **数据库**         |                                               **支持的版本**                                                |
|-------------------------|--------------------------------------------------------------------------------------------------------|
| OceanBase 数据库 Oracle 模式 | V2.0.x、V2.1.x、V2.2.20、V2.2.30、V2.2.50、V2.2.70、V2.2.71、V2.2.72、V2.2.76、V3.1.x、V3.2.x                    |
| OceanBase 数据库 MySQL 模式  | V1.4.70、V1.4.72、V1.4.75、V1.4.78、V 1.4.79、V2.2.30、V2.2.50、V2.2.70、V2.2.71、V2.2.72、V2.2.76、V3.1.x、V3.2.x |


> **注意**<br>
> 自导数工具 V3.0.0 版本起，导数工具支持 OceanBase 社区版。
> 社区版导数工具（OBLOADER \& OBDUMPER）需搭配社区版 OceanBase V3.1.2 及以上版本使用。


注意事项 
-------------------------

* 标准的 CSV 格式可阅读 RFC 4180 规范，推荐导入导出严格遵从 RFC 4180 规范。

  

* 导入导出大规模的数据量时，请在运行的脚本中修改虚拟机的内存参数（默认：-Xms4G -Xmx4G）。

  

* 命令行参数指定的对象名、数据文件名、规则文件名要求大小写一致。Oracle 默认大写，MySQL 默认小写。

  

* 导入的数据文件命名格式，统一为：table.group.sequence.suffix。

  

* 数据库中存在有外键的表时，无法保证结构和数据按照依赖顺序导入，可能会导入失败。

  

* 无主键的表，暂不支持中断续传。

  

* 导入时，要求指定的对象名与数据文件名大小写一致。如果数据库中同时存在大写和小写的对象，那么小写的对象名和文件名需要使用双引号包含起来。

  

* OceanBase 数据库 MySQL 模式 V1.4.79 版本使用 `insert ... where not exists` 句型解决主键冲突时，可能存在跨分区插入的问题。

  

* 在 Windows 系统上，数据库对象的名称不可包含 \\ / : \* ? " \< \> \| 否则无法正常导出。

  

* 在 windows 系统上，不能使用 ！做分隔符。

  

* OceanBase 数据库 MySQL 模式 V1.4.x 版本 RANGE_COLUMNS + KEY 在虚拟路由视图中的元数据有缺陷。

  

* OceanBase 数据库 ORACLE 模式 不支持导入导出虚拟列的数据（已修复 OBMySQL 模式，导出数据时忽略虚拟列，否则无法导入虚拟数据）。

  

* OBLOADER 支持的文件格式如下所示：

  * DDL 文件格式：文件中仅包含 DDL 语句。

    
  
  * SQL 文件格式：文件中的仅包含 `INSERT` 语句，记录不跨行。

    
  
  * MIX 混合文件格式：文件中包含 DDL 和 DML 等多种混合的语句。

    
  
  * POS 文件格式：文件中的数据是根据字节（非字符）偏移位置产生的。

    
  
  * CUT 文件格式：文件中的数据是根据字符串分隔，区别于 CSV 格式的单个字符分隔。

    
  

  




限制模式 
-------------------------

> **说明**<br>
> 此限制模式仅适用于公有云部署的服务。

* OBLOADER 可通过指定 `--public-cloud` 选项使用限制模式导入数据。在限制模式下 OBLOADER 不依赖系统租户下的任何用户，即无需指定 `--sys-user` 和 `--sys-password` 选项。

  

* 限制模式会限制部分导入的功能、性能以及稳定性。同时，OceanBase 数据库 V2.2.30 及以上版本才支持服务端限流的能力，因此在使用限制模式时通过以下命令调整服务端限流：

  ```sql
  alter system set freeze_trigger_percentage=50;
  alter system set minor_merge_concurrence=64;
  alter system set writing_throttling_trigger_percentage=80 tenant='xxx';
  ```
<!-- -->

* 使用限制模式（`--public-cloud`）于公有云相关的服务时，无需指定 `-t`、`-c` 连接选项。